version: 1.0.0
type: REST_API
buildSpec:
  env: docker
  builder: default
  buildCommand: docker build -t ${PROJECT_NAME} .
  dockerfile: Dockerfile
metadata:
  name: deepseek-api
  displayName: DeepSeek Coder API
  description: REST API for code generation using DeepSeek Coder model with Ollama integration
  icon: https://raw.githubusercontent.com/wso2/choreo-samples/main/icons/python.png
  projectVersion: 1.0.0
  tags:
    - ai
    - code-generation
    - ollama
    - deepseek
    - python
    - rest-api
  annotations:
    categories: ["AI/ML"]
    platform: "Python"
    tier: "Free"
deploySpec:
  replicas: 1
  envs:
    - name: OLLAMA_API_BASE_URL
      value: "${OLLAMA_API_URL}"
      description: "OLLAMA API base URL (e.g., http://your-ollama-host:11434)"
      required: true
    - name: MODEL_NAME
      value: "deepseek-coder"
      description: "OLLAMA model name to use"
      required: true
    - name: REQUEST_TIMEOUT
      value: "300"
      description: "Request timeout in seconds"
      required: false
    - name: RATE_LIMIT_PER_MINUTE
      value: "60"
      description: "Rate limit per minute"
      required: false
  containers:
    - image: ${PROJECT_NAME}
      name: main
      ports:
        - containerPort: 8080
          name: http
          protocol: TCP
          servicePort: 8080
      resources:
        requests:
          cpu: "0.1"
          memory: "128Mi"
        limits:
          cpu: "0.5"
          memory: "256Mi"
      livenessProbe:
        httpGet:
          path: /health
          port: 8080
        initialDelaySeconds: 30
        periodSeconds: 30
        timeoutSeconds: 10
      readinessProbe:
        httpGet:
          path: /health
          port: 8080
        initialDelaySeconds: 15
        periodSeconds: 10
        timeoutSeconds: 5