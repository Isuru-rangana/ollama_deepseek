schemaVersion: v1
type: container
metadata:
  name: ollama
  displayName: ollama
  description: DeepSeek Coder API with OLLAMA integration
  icon: https://raw.githubusercontent.com/wso2/choreo-samples/main/icons/python.png
  labels:
    - ai
    - code-generation
    - ollama
    - deepseek

container:
  image: ollama
  port: 8000
  dockerFile:
    path: Dockerfile
    buildContext: .

envs:
  - name: OLLAMA_API_BASE_URL
    defaultValue: http://localhost:11434
    required: true
  - name: OLLAMA_MODEL_NAME
    defaultValue: deepseek-coder
    required: true
  - name: REQUEST_TIMEOUT
    defaultValue: "300"
    required: false
  - name: RATE_LIMIT_PER_MINUTE
    defaultValue: "60"
    required: false

resources:
  requests:
    cpu: 0.5
    memory: 512Mi
  limits:
    cpu: 1
    memory: 1Gi

endpoints:
  - name: health
    port: 8000
    type: REST
    context: /
    basePath: /health
    operations:
      - method: GET
        secured: false
  - name: model
    port: 8000
    type: REST
    context: /api/v1
    basePath: /model
    operations:
      - method: GET
        secured: true
  - name: generate
    port: 8000
    type: REST
    context: /api/v1
    basePath: /generate
    operations:
      - method: POST
        secured: true 