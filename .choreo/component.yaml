version: 0.1.0
type: COMPONENT
componentType: service
buildPack: docker
buildSpec:
  env:
    - name: OLLAMA_API_BASE_URL
      defaultValue: http://localhost:11434
      required: true
    - name: OLLAMA_MODEL_NAME
      defaultValue: deepseek-coder
      required: true
    - name: REQUEST_TIMEOUT
      defaultValue: "300"
      required: false
    - name: RATE_LIMIT_PER_MINUTE
      defaultValue: "60"
      required: false
  ports:
    - name: http
      port: 8000
      type: http
  resources:
    cpu:
      required: 0.5
      limit: 1.0
    memory:
      required: "512Mi"
      limit: "1Gi"
  docker:
    context: .
    file: Dockerfile
    buildArgs: []
metadata:
  name: ollama-deepseek
  description: DeepSeek Coder API with OLLAMA integration
  labels:
    - ai
    - code-generation
    - ollama
    - deepseek
    - python
    - rest-api
  projectType: Application
  icon: https://raw.githubusercontent.com/wso2/choreo-samples/main/icons/python.png

deploy:
  restApi:
    apiType: REST
    port: 8000
    context: /
    basePath: /
    production:
      replicas: 1
      resources:
        requests:
          cpu: "0.5"
          memory: "512Mi"
        limits:
          cpu: "1"
          memory: "1Gi"
    cors:
      enabled: true
      allowOrigins:
        - "*"
    security:
      enabled: true
      authTypes:
        - OAuth2
    endpoints:
      - name: "Health Check"
        basePath: /health
        secured: false
        operations:
          - target: /health
            verb: GET
            secured: false
            summary: "Health check endpoint"
      - name: "Model Info"
        basePath: /api/v1/model
        operations:
          - target: /api/v1/model
            verb: GET
            secured: true
            summary: "Get model information"
      - name: "Code Generation"
        basePath: /api/v1/generate
        operations:
          - target: /api/v1/generate
            verb: POST
            secured: true
            summary: "Generate code using DeepSeek Coder" 